<!DOCTYPE html>
<html lang="en">

<head>
  <meta name="description" content="Unlock YouTube content with TubExtractor.com. Extract video transcripts, tags, title, channel info, download in preferred formats, or convert to MP3. Ideal for creators, SEOs, and video lovers.">
  <meta charset="utf-8">
  <title>TubExtractor</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Favicon generale -->
  <link rel="icon" href="{{ url_for('static', filename='img/favicon.ico') }}">

  <!-- Favicon per dispositivi Apple -->
  <link rel="apple-touch-icon" sizes="180x180" href="{{ url_for('static', filename='img/apple-touch-icon.png') }}">

  <!-- Favicon per Android / Chrome -->
  <link rel="icon" type="image/png" sizes="192x192"  href="{{ url_for('static', filename='img/android-chrome-192x192.png') }}">
  <link rel="icon" type="image/png" sizes="512x512"  href="{{ url_for('static', filename='img/android-chrome-512x512.png') }}">

  <!-- Favicon per desktop generali -->
  <link rel="icon" type="image/png" sizes="16x16" href="{{ url_for('static', filename='img/favicon-16x16.png') }}">
  <link rel="icon" type="image/png" sizes="32x32" href="{{ url_for('static', filename='img/favicon-32x32.png') }}">

  <!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-KXPGCQ7');</script>
  <!-- End Google Tag Manager -->
<!--Adsense-->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5805851655514225" crossorigin="anonymous"></script>
<!--fine adsense-->
 
  
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="{{ url_for('static', filename='css/bootstrap.min.css') }}">
  <!-- Google Fonts -->
  <link rel="preload" href="{{ url_for('static', filename='css/fontfamily_dm.css') }}" as="style">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/fontfamily_dm.css') }}" media="print" onload="this.media='all'">
   <!--font Style -->
  <style>
    body.font-family {
      font-family: 'DM Sans', sans-serif;
    }
    .btn-pink-moon {
    background: #ec008c;  /* fallback for old browsers */
    background: -webkit-linear-gradient(to right, #fc6767, #ec008c);  /* Chrome 10-25, Safari 5.1-6 */
    background: linear-gradient(to right, #fc6767, #ec008c); /* W3C, IE 10+/ Edge, Firefox 16+, Chrome 26+, Opera 12+, Safari 7+ */
    color: #fff;
    }
    .btn-pink-moon:hover {
      background: #A770EF;  /* fallback for old browsers */
    background: -webkit-linear-gradient(145deg, #FDB99B, #CF8BF3, #A770EF);  /* Chrome 10-25, Safari 5.1-6 */
    background: linear-gradient(145deg, #FDB99B, #CF8BF3, #A770EF); /* W3C, IE 10+/ Edge, Firefox 16+, Chrome 26+, Opera 12+, Safari 7+ */
    color: #fff;
    }
    .col-12 {
    max-width: 100%;
  }
  
  </style>
  
</head>

<body class="font-family">
  <section class="text-center">
    <div class="container p-1 mb-5">
      <div class="row justify-content-center text-md-center">
        <div class="col-lg-10 col-xl-8 mb-0">
          <img src="{{ url_for('static', filename='img/tubextractor.png') }}" alt="logo Tubextractor" width="200px" height="200px">
          <h1>
            TubExtractor
          </h1>
        </div>
        <div class="col-md-9 col-lg-7 col-xl-6 col-xxl-5 mb-10">
          
          <p class="lead mb-3">
            Download videos, transcripts, tags or convert Video to MP3. Perfect for creators and SEO experts
           </p>
        </div>
      </div>
      <br>
      <form method="post" enctype="multipart/form-data" class="js-ajax-form mb-10">
        {{ form.hidden_tag() }}
        <div class="row justify-content-center text-md-center">
            <div class="col-md-6 col-lg-8 col-xl-6">
                <div class="input-group mb-2">
                    {{ form.video_id(class="form-control form-control-lg", placeholder="Enter the video URL", required="required") }}
                </div>
            </div>
            <div class="col-md-6 col-lg-4 col-xl-2">
                {{ form.submit(class="btn btn-pink-moon btn-lg btn-block w-100") }}
            </div>
        </div>
    </form>
      <div id="loader" style="display: none;">
        <p class="h4 m-5">loading...</p>
          </div>
          <p id="error-message" style="color: red;"></p>

      </div>
    </section>
<br>
      <section id="video-info" style="display: none;">
        <div class="container bg-dark text-light p-5 rounded-3">
          <div class="row mb-5">
            <div class="col-sm-8 col-lg-4 mb-3">
              <img id="thumbnail-img" src="" alt="video Thumbnail">
              </div>
            <div  class="col-sm-4 col-lg-8"> 
              <h2 id="video-title" class="h3 mb-12 w-100"></h2>
              <p id="channel-title"></p>
              <p class="mb-2"><strong>Duration:</strong> <span id="video-duration-value"></span></p>
              <select id="format-select" class="form-select p-3">
                {% for format in video_info.formats %}
                <option value="{{ format.format_id }}">{{ format.ext }} - {{ format.format_note }}</option>
                {% endfor %}
              </select>
              <br>
              <button id="download-button" class="btn btn-pink-moon btn-lg btn-block w-100 p-3">
                <i class="fas fa-download"></i> Download
            </button>
            <div id="loading-message" style="display: none;">
              <p class="m-5">loading...</p>
          </div>
                  </section>
             

          <!-- Add this section for the textarea -->
          
          <section class="m-5" id="video-info2" style="display: none;">
            <div class="row m-5 justify-content-center">
              <div class="col-md-6 col-sm-12 text-center mb-3">
                <img src="{{ url_for('static', filename='img/paper-writing.svg') }}" alt="icon transcript Tubextractor" width="64px" class="mb-3">
                <textarea id="transcription-textarea" class="form-control mb-2 w-100" rows="5"></textarea>
                <button class="btn btn-pink-moon w-100 p-3" id="copy-transcription-btn">Copy Transcript</button>
              </div>
              <div class="col-md-6 col-sm-12 text-center">
                <img src="{{ url_for('static', filename='img/tags.svg') }}" alt="icon tags Tubextractor" width="64px" class="mb-3">
                <textarea id="tags-textarea" class="form-control mb-2 w-100" rows="5"></textarea>
                <button class="btn btn-pink-moon w-100 p-3" id="copy-tags-btn">Copy Tags</button>
              </div>
            </div>
          </section>
          <!-- Add section for audio download-->
          <section id="audio-info" style="display: none;">
            <div class="container bg-light text-dark p-5 rounded-3">
              <div class="row mb-5">
                <div class="col-sm-8 col-lg-4 mb-3">
                  <img src="{{ url_for('static', filename='img/tubextractor_mp3.png') }}" alt="icon tags Tubextractor" width="300px" class="mb-3">
                                  </div>
                <div  class="col-sm-4 col-lg-8"> 
                  <h2 class="h3 mb-12 w-100"> Video to mp3</h2>
                  <p class="lead mb-3">Experience seamless conversion of your favorite YouTube videos to high-quality MP3 audio files. Perfect for offline listening, podcast creation, or any other audio-focused project. Start your audio adventure with TubExtractor.</p>
   <a href="/download_audio" download>
                      <button id="download-audio" class="btn btn-pink-moon btn-lg btn-block w-100 p-3">
                        <i class="fas fa-download"></i> Download MP3
                    </button>
                </a><br>
                <p id="loading-message-audio" style="display: none;">Loading...</p>
       </div>
      </div>
    </div>
  </section>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.2/dist/js/bootstrap.bundle.min.js"
    data-integrity="38d870e9c3c4e532551b530706abb811"></script>
<!--fontawesome -->
<script src="https://kit.fontawesome.com/bac6d897cb.js" crossorigin="anonymous"></script>
  
  <!-- Custom script -->
  <script>
    var videoId;
    var loadingMessage = document.querySelector('#loading-message');
    var downloadButton = document.querySelector('#download-button');
    var errorMessageElement = document.querySelector('#error-message');

    function get_youtube_video_id(url) {
        var video_id;
        if (url.includes('youtu.be')) {
            // Handle https://youtu.be/<video_id> format
            video_id = url.split('youtu.be/')[1];
        } else if (url.includes('youtube.com/watch')) {
            // Handle https://www.youtube.com/watch?v=<video_id> format
            video_id = url.split('v=')[1];
            var ampersandPosition = video_id.indexOf('&');
            if (ampersandPosition != -1) {
                video_id = video_id.substring(0, ampersandPosition);
            }
        }
        return video_id;
    }

    function validateYouTubeUrl(url) {
        var youtubeUrlRegex = /^https?:\/\/(www\.)?(youtube\.com\/watch\?v=[^&]+|youtu\.be\/[^&]+)/;
        return youtubeUrlRegex.test(url);
    }
    document.querySelector('.js-ajax-form').addEventListener('submit', function (event) {
        event.preventDefault();

        // Clear the results from the previous search and any error message
        document.querySelector('#transcription-textarea').value = '';
        document.querySelector('#tags-textarea').value = '';
        errorMessageElement.textContent = '';

        var loader = document.querySelector('#loader');
        loader.style.display = 'block';
        loadingMessage.style.display = 'none'; // Hide the loading message
        downloadButton.disabled = true;

        var videoUrl = document.querySelector('input[name="video_id"]').value;
if (!validateYouTubeUrl(videoUrl)) {
    errorMessageElement.textContent = 'Invalid YouTube URL. Please enter a valid URL, such as https://www.youtube.com/watch?v=abc123 or https://youtu.be/abc123';
    loader.style.display = 'none';
    downloadButton.disabled = false;
    return;
}


        videoId = get_youtube_video_id(videoUrl);

        // Push the URL to dataLayer
        window.dataLayer = window.dataLayer || [];
        window.dataLayer.push({
            'event': 'video_url_entered',
            'video_url': videoUrl
        });

        fetch('/get_video_info', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({video_id: videoId})
        })
            .then(function (response) {
                loader.style.display = 'none';
                downloadButton.disabled = false; // Enable the download button
                return response.json();
            })
            .then(function (data) {
                var durationValueElement = document.querySelector('#video-duration-value');
                durationValueElement.textContent = data.duration; // Set the duration value

                var transcriptionTextarea = document.querySelector('#transcription-textarea');
                var tagsTextarea = document.querySelector('#tags-textarea');
                transcriptionTextarea.value = data.transcript;
                tagsTextarea.value = data.tags.join(', ');
                document.querySelector('#video-title').textContent = data.title;
                document.querySelector('#channel-title').textContent = 'POSTED BY: ' + data.channel_title;
                document.querySelector('#thumbnail-img').src = data.thumbnail;

                // Populate the formats dropdown
                var formatSelect = document.querySelector('#format-select');
                formatSelect.innerHTML = '';
                for (var i = 0; i < data.formats.length; i++) {
                    var formatOption = document.createElement('option');
                    formatOption.value = data.formats[i].format_id;
                    formatOption.textContent = data.formats[i].ext + ' - ' + data.formats[i].format_note;
                    var iconElement = document.createElement('i');
                    iconElement.classList.add('fas', 'fa-video');
                    formatOption.appendChild(iconElement);
                    formatSelect.appendChild(formatOption);
                }

                // Add the download button's click event
                downloadButton.removeEventListener('click', handleDownloadButtonClick);
                downloadButton.addEventListener('click', handleDownloadButtonClick);

                // Show the results section
                document.querySelector('#video-info').style.display = 'block';
                document.querySelector('#video-info2').style.display = 'block';
                document.querySelector('#audio-info').style.display = 'block';

                // Clear the form for a new search
                document.querySelector('.js-ajax-form').reset();
            })
            .catch(function (error) {
                console.log('Error during fetch:', error);
                loader.style.display = 'none';
                loadingMessage.style.display = 'none'; // Hide the loading message in case of error
                downloadButton.disabled = false; // Enable the download button in case of error
            });
    });

    function handleDownloadButtonClick() {
    // Get the selected format
    var selectedFormat = document.querySelector('#format-select').selectedOptions[0];
    if (!selectedFormat) return; // If no format is selected, do nothing
    // Show the loading message
    loadingMessage.style.display = 'block';
    downloadButton.disabled = true; // Disable the download button during the download process

    // Push the selected format to dataLayer
    window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'event': 'download_button_clicked',
        'selected_format_id': selectedFormat.value,
        'selected_format_text': selectedFormat.textContent,
        'click_time': new Date().getTime()
    });

    // Redirect to the download URL
    window.location.href = '/download_video/' + selectedFormat.value + '?video_id=' + videoId;
    // Enable the download button after a short delay (adjust the delay as needed)
    setTimeout(function () {
        loadingMessage.style.display = 'none'; // Hide the loading message after the download
        downloadButton.disabled = false;
    }, 1000);
}


    // Add the event listeners for copying the transcript and tags
    document.querySelector('#copy-transcription-btn').addEventListener('click', function () {
        var transcriptionText = document.querySelector('#transcription-textarea').value;
        copyToClipboard(transcriptionText);
        window.dataLayer.push({
            'event': 'button_click',
            'button_name': 'copy_transcription',
            'click_time': new Date().getTime()
        });
    });

    document.querySelector('#copy-tags-btn').addEventListener('click', function () {
        var tagsText = document.querySelector('#tags-textarea').value;
        copyToClipboard(tagsText);
        window.dataLayer.push({
            'event': 'button_click',
            'button_name': 'copy_tags',
            'click_time': new Date().getTime()
        });
    });

    // Utility function for copying text to clipboard
    function copyToClipboard(text) {
        var textarea = document.createElement('textarea');
        textarea.value = text;
        document.body.appendChild(textarea);
        textarea.select();
        document.execCommand('copy');
        document.body.removeChild(textarea);
        alert('Text copied to clipboard!');
    }

    // Add the event listeners for audio
    document.querySelector('#download-audio').addEventListener('click', function () {
        document.querySelector('#loading-message-audio').style.display = 'block';
        // Nascondi la scritta "Loading..." dopo 20 secondi
        setTimeout(function () {
            document.querySelector('#loading-message-audio').style.display = 'none';
        }, 20000); // 20000 millisecondi corrispondono a 20 secondi

        window.dataLayer.push({
            'event': 'button_click',
            'button_name': 'download_audio',
            'click_time': new Date().getTime()
        });
    });

</script>







</body>
</html>
